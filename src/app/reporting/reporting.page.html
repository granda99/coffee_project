<ion-header>
  <ion-row>
    <ion-col size="0.5" size-lg class="hidden"></ion-col>
    <ion-col size="4" size-lg>
      <h5 style="margin-top: 12px;">Reportería</h5>
    </ion-col>
    <ion-col size="7.5" size-lg>
      <ion-row>
        <ion-col [hidden]="!dowReport" size="10" size-lg><br><br></ion-col>
        <ion-col [hidden]="dowReport" size="2" size-lg>
          <ion-icon class="center-element infoI" name="cloud-download-outline"></ion-icon>
        </ion-col>
        <ion-col [hidden]="dowReport" size="5" size-lg>
          <ion-button (click)="exportData('rep')" class="botton-orange bold" expand="block">REPORTE
          </ion-button>
        </ion-col>
        <ion-col [hidden]="dowReport" size="5" size-lg>
          <ion-button (click)="exportData('all')" class="botton-orange bold" expand="block">TODO
          </ion-button>
        </ion-col>
        <ion-col size="2" size-lg>
          <ion-icon (click)="presentInfo()" class="infoI right-element icon" name="information-circle-outline">
          </ion-icon>
        </ion-col>
      </ion-row>
    </ion-col>
  </ion-row>
</ion-header>

<ion-content style="overflow:hidden;">
  <div class="back">
    <!-- SELECT REPORT TYPE -->
    <ion-row class="menu-back">
      <ion-col size="6">
        <ion-label class="label">Tipo de reporte</ion-label>
      </ion-col>
      <ion-col size="6">
        <ion-select placeholder="Selecione Uno" (ionChange)="selectReport($event.detail.value)">
          <ion-select-option value="">Seleccione</ion-select-option>
          <ion-select-option value="Rango">Rango</ion-select-option>
          <ion-select-option value="Hasta">Hasta</ion-select-option>
          <ion-select-option value="Día">Día</ion-select-option>
          <ion-select-option value="Anual">Anual</ion-select-option>
        </ion-select>
      </ion-col>
    </ion-row>
    <ion-row class="menu-back" [hidden]="active">
      <!-- RANGO -->
      <ion-col size="6" [hidden]="!showReport[0]">
        <!-- SELECT DATE START -->
        <ion-item button="true" id="open-date-fechaInit" [disabled]="active">
          <ion-label>Inicio</ion-label>
          <ion-text slot="end">{{ fechaInit }}</ion-text>
          <ion-popover trigger="open-date-fechaInit" show-backdrop="false">
            <ng-template>
              <ion-datetime #popoverDatetime presentation="date" (ionChange)="dateStart(popoverDatetime.value)">
              </ion-datetime>
            </ng-template>
          </ion-popover>
        </ion-item>
      </ion-col>
      <ion-col size="6" [hidden]="!showReport[0]">
        <!-- SELECT DATE END -->
        <ion-item button="true" id="open-date-fechaFin" [disabled]="active">
          <ion-label>Fin</ion-label>
          <ion-text slot="end">{{ fechaFin }}</ion-text>
          <ion-popover trigger="open-date-fechaFin" show-backdrop="false">
            <ng-template>
              <ion-datetime #popoverDatetime presentation="date" (ionChange)="dateEnd(popoverDatetime.value)">
              </ion-datetime>
            </ng-template>
          </ion-popover>
        </ion-item>
      </ion-col>
      <!-- HASTA -->
      <ion-col size="12" [hidden]="!showReport[1]">
        <!-- SELECT DATE UNTIL -->
        <ion-item button="true" id="open-date-until" [disabled]="active">
          <ion-label>Fecha</ion-label>
          <ion-text slot="end">{{ fechaInit }}</ion-text>
          <ion-popover trigger="open-date-until" show-backdrop="false">
            <ng-template>
              <ion-datetime #popoverDatetime presentation="date" (ionChange)="dateStart(popoverDatetime.value)">
              </ion-datetime>
            </ng-template>
          </ion-popover>
        </ion-item>
      </ion-col>
      <!-- DAY -->
      <ion-col size="12" [hidden]="!showReport[2]">
        <!-- SELECT DATE DAY -->
        <ion-item button="true" id="open-date-day" [disabled]="active">
          <ion-label>Día</ion-label>
          <ion-text slot="end">{{ fechaInit }}</ion-text>
          <ion-popover trigger="open-date-day" show-backdrop="false">
            <ng-template>
              <ion-datetime #popoverDatetime presentation="date" (ionChange)="dateStart(popoverDatetime.value)">
              </ion-datetime>
            </ng-template>
          </ion-popover>
        </ion-item>
      </ion-col>
      <!-- SELECT YEAR REPORT -->
      <ion-col size="12" [hidden]="!showReport[3]">
        <ion-select placeholder="Selecione Uno" (ionChange)="selectedAnio($event.detail.value)" [disabled]="active">
          <ion-select-option value="">Seleccione</ion-select-option>
          <ion-select-option value="2022">2022</ion-select-option>
          <ion-select-option value="2023">2023</ion-select-option>
        </ion-select>
      </ion-col>
    </ion-row>
    <ion-row class="menu-back" [hidden]="activeParam">
      <!-- TITLE PARAM TYPE -->
      <ion-col size="6">
        <ion-label class="label">Parámetro</ion-label>
      </ion-col>
      <!-- SELECT PARAM TYPE-->
      <ion-col size="6">
        <ion-select placeholder="Selecione Uno" (ionChange)="selectedParam($event.detail.value)">
          <ion-select-option value="">Todos</ion-select-option>
          <ion-select-option value="HT">Humedad de la tierra</ion-select-option>
          <!-- <ion-select-option value="PH">PH de la tierra</ion-select-option> -->
          <ion-select-option value="HA">Humedad del ambiente</ion-select-option>
          <ion-select-option value="TA">Temperatura del ambiente</ion-select-option>
          <ion-select-option value="LA">Luz del ambiente</ion-select-option>
          <ion-select-option value="PA">Presión ambiente</ion-select-option>
        </ion-select>
      </ion-col>
    </ion-row>

    <!-- REPOORT -->
    <ion-row [hidden]="showReportInfo">
      <ion-col size="1"> </ion-col>
      <ion-col size="10" class="chart" [hidden]="showLine">
        <ion-card>
          <ion-card-header>
            {{factor || 'TODO'}}
          </ion-card-header>
          <ion-card-content>
            <canvas #lineCanvas style="position: relative; height:20vh; width:40vw"></canvas>
          </ion-card-content>
        </ion-card>
      </ion-col>
      <ion-col size="1"> </ion-col>
    </ion-row>
    <ion-row [hidden]="showReportInfo">
      <ion-col size="1"> </ion-col>
      <ion-col size="10" class="chart" [hidden]="!showLine">
        <ion-card>
          <ion-card-header>
            {{factor || 'TODO'}}
          </ion-card-header>
          <ion-card-content [hidden]="!dona[0]">
            <canvas #doughnutCanvas style="position: relative; height:15vh; width:40vw"></canvas>
          </ion-card-content>
          <ion-card-content [hidden]="!dona[1]">
            <canvas #doughnutCanvas1 style="position: relative; height:15vh; width:40vw"></canvas>
          </ion-card-content>
          <ion-card-content [hidden]="!dona[2]">
            <canvas #doughnutCanvas2 style="position: relative; height:15vh; width:40vw"></canvas>
          </ion-card-content>
          <ion-card-content [hidden]="!dona[3]">
            <canvas #doughnutCanvas3 style="position: relative; height:15vh; width:40vw"></canvas>
          </ion-card-content>
          <ion-card-content [hidden]="!dona[4]">
            <canvas #doughnutCanvas4 style="position: relative; height:15vh; width:40vw"></canvas>
          </ion-card-content>
          <ion-card-content [hidden]="!dona[5]">
            <canvas #doughnutCanvas5 style="position: relative; height:15vh; width:40vw"></canvas>
          </ion-card-content>
        </ion-card>
      </ion-col>
      <ion-col size="1"> </ion-col>
    </ion-row>

    <ion-refresher style="background: transparent;" slot="fixed" pullFactor="0.5" pullMin="100" pullMax="200"
      (ionRefresh)="doRefresh($event)">
      <ion-refresher-content style="background: transparent;"></ion-refresher-content>
    </ion-refresher>

    <!--   <table id="excel-tablePropiedades" class="table table-sm table-bordered print" style="width: 100%">
      <thead class="thead-dark">
        <tr>
          <th colspan="4" class="bgcol">
            DATASET
          </th>
        </tr>
        <tr>
          <th>Dispositivo</th>
          <th>HT</th>
          <th>PH</th>
          <th>HA</th>
          <th>LA</th>
          <th>TA</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of dataset">
          <td> {{item.dispositivo}} </td>
          <td> {{item.parametros_tierra.HT}}</td>
          <td> {{item.parametros_tierra.PH}}</td>
          <td> {{item.parametros_ambiente.HA}} </td>
          <td> {{item.parametros_ambiente.LA}} </td>
          <td> {{item.parametros_ambiente.TA}} </td>
        </tr>
      </tbody>
    </table> -->
  </div>
</ion-content>